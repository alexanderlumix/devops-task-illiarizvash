# Vulnerability Scanning Configuration

# Trivy Configuration
trivy:
  # Scan types: fs, image, repo, client
  scan_type: fs
  
  # Severity levels to report
  severity: CRITICAL,HIGH,MEDIUM
  
  # Output formats
  formats:
    - table
    - json
    - sarif
  
  # Ignore specific vulnerabilities
  ignore:
    - CVE-2023-1234  # Example: Known false positive
    - CVE-2023-5678  # Example: Mitigated vulnerability
  
  # Skip directories
  skip_dirs:
    - node_modules
    - .git
    - vendor
    - dist

# Bandit Configuration (Python Security Linter)
bandit:
  # Severity levels
  severity: HIGH,MEDIUM
  
  # Confidence levels
  confidence: HIGH,MEDIUM
  
  # Output format
  output_format: json
  
  # Skip tests
  skip_tests: true
  
  # Exclude paths
  exclude:
    - tests/
    - __pycache__/
    - .venv/

# ESLint Security Plugin Configuration
eslint_security:
  # Security rules
  rules:
    security/detect-object-injection: error
    security/detect-non-literal-regexp: error
    security/detect-unsafe-regex: error
    security/detect-buffer-noassert: error
    security/detect-child-process: error
    security/detect-disable-mustache-escape: error
    security/detect-eval-with-expression: error
    security/detect-no-csrf-before-method-override: error
    security/detect-non-literal-fs-filename: error
    security/detect-non-literal-require: error
    security/detect-possible-timing-attacks: error
    security/detect-pseudoRandomBytes: error

# Go Security Scanner Configuration
gosec:
  # Output format
  output_format: json
  
  # Include tests
  include_tests: false
  
  # Severity levels
  severity: HIGH,MEDIUM
  
  # Exclude rules
  exclude:
    - G101  # Look for hardcoded credentials
    - G102  # Bind to all interfaces
    - G103  # Audit the use of unsafe block
    - G104  # Audit errors not checked
    - G105  # Audit the use of big.Exp function
    - G106  # Audit the use of ssh.InsecureIgnoreHostKey function
    - G107  # Url provided to HTTP request as taint input
    - G108  # Use of net/http serve function that has no support for setting timeouts
    - G109  # Converting strconv.Atoi result to int32/int16
    - G110  # Potential DoS vulnerability via decompression bomb
    - G111  # Potential DoS vulnerability via decompression bomb
    - G112  # Potential DoS vulnerability via decompression bomb
    - G113  # Use of http.ListenAndServe instead of https.ListenAndServeTLS
    - G114  # Use of net/http serve function that has no support for setting timeouts
    - G201  # SQL query construction using format string
    - G202  # SQL query construction using string concatenation
    - G203  # Use of unescaped data in HTML templates
    - G204  # Audit use of command execution
    - G301  # Poor file permissions used when creating a directory
    - G302  # Poor file permissions used with chmod
    - G303  # Creating tempfile using a predictable path
    - G304  # Potential file inclusion via variable
    - G305  # File path traversal when extracting zip/tar archive
    - G306  # Poor file permissions used when writing to a file
    - G307  # Poor file permissions used when creating a file
    - G401  # Detect the usage of DES, RC4, MD5 or SHA1
    - G402  # Look for bad TLS connection settings
    - G403  # Ensure minimum RSA key length of 2048 bits
    - G404  # Insecure random number source (rand)
    - G501  # Import blacklist: crypto/md5
    - G502  # Import blacklist: crypto/des
    - G503  # Import blacklist: crypto/rc4
    - G504  # Import blacklist: net/http/cgi
    - G505  # Import blacklist: crypto/sha1
    - G601  # Implicit memory aliasing in for loop

# Dependency Scanning
dependency_check:
  # Scan for known vulnerabilities in dependencies
  enabled: true
  
  # Update vulnerability database
  update_db: true
  
  # Output formats
  formats:
    - HTML
    - JSON
    - XML
  
  # Fail build on high severity
  fail_on_high: true

# Container Security
container_security:
  # Scan base images
  scan_base_images: true
  
  # Check for secrets in images
  detect_secrets: true
  
  # Validate image signatures
  verify_signatures: true
  
  # Check for unnecessary packages
  check_packages: true 